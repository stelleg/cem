
# Shell takes a line and turns it into 
shell = \line.(words line nil \cmd.\args.(fork nil (0 =)
    (exec cmd args \n.[(print "command not found") then (exit n)])
    (wait 0)))

# Quits on ctrl-d (eof), otherwise returns the line
getLineOrQuit = \world.(takeWhile \c.[c '\n' /=] (readFd 0 world
  (error "goodbye") 
  \h.\t.(Cons h t)))

# Loops forever on getLines and shells
main = (forever \world.[(putStr "> ") then shell getLineOrQuit world] initworld)
